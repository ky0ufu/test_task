Рассмотрим формирование файла comments.csv, он должен содержать:
- логин пользователя, 
- заголовок поста (header) к которому он оставлял комментарии
- логин автора поста
- кол-во комментариев
Нам дан логин пользователя, который оставил комментарий.

1. С его помощью в первой базе данных можно узнать о постах, который написал пользователь либо о блогах, который написал тот же пользователь.
Отсюда информацию о комментариях под постом узнать не можем.

2. Во второй базе данных через логин пользователя можно узнать о действиях пользователя. Какие действия сделал пользователь и сколько.
Но узнать под каким постом пользователь оставил комментарий или в каком блоге пользователь создал пост узнать нельзя.

Следовательно появляется вопрос, как можно зная логин пользователя получить информацию о посте под которым он оставил комментарий.
Решение проблемы:
Можно добавить в первой базе данных таблицу comments содержащию информацию о комментариях (id, author_id, text, post_id).
Тогда можно будет узнать под каким постом был оставлен комментарий и количество комментариев под постом.

3. Чтобы агрегировать данные в general.csv нужно группировать данные по дате. 
Если сгруппировать данные просто по дате, не по каким-то промежуткам (выбраны дни), то тогда почти каждая строка в файле general.csv будет показывать действие в количестве 1.
